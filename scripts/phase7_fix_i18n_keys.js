/**
 * Phase 7: Fix missing labUpload i18n keys across ALL locales.
 * Ensures every locale has the same set of labUpload.* keys as en.json.
 *
 * Run: node scripts/phase7_fix_i18n_keys.js
 */

const fs = require('fs');
const path = require('path');

const LOCALES_DIR = path.join(__dirname, '..', 'src', 'presentation', 'i18n', 'locales');

// Full translated labUpload blocks for each locale
const TRANSLATIONS = {
  de: {
    title: 'Laborbericht hochladen',
    selectFile: 'Datei auswählen',
    processing: 'Wird analysiert...',
    valuesFound: '{{count}} Werte erkannt',
    importValues: 'Werte importieren ({{count}})',
    noValues: 'Keine Werte erkannt',
    ocrRequired: 'OCR-Zustimmung erforderlich',
    ocrNotAvailable: 'OCR ist auf diesem Gerät nicht verfügbar.',
    notSupported: 'Laborbericht-Upload ist auf dieser Plattform nicht verfügbar.',
    mobilOnly: 'Diese Funktion ist nur auf iOS und Android verfügbar.',
    description: 'Laden Sie einen Laborbericht hoch (Bild oder PDF). Die Werte werden lokal per OCR erkannt und können in den Rechner übernommen werden.',
    confidence: 'OCR-Konfidenz: {{percent}}%',
    noValuesHint: 'Versuchen Sie ein schärferes Bild oder einen anderen Laborbericht.',
    importHint: '{{count}} Werte können in den Rechner importiert werden.',
    noImportableHint: 'Keiner der erkannten Werte kann automatisch in den Rechner importiert werden.',
    noImportableValues: 'Keine importierbaren Werte ausgewählt.',
    importSuccess: '{{count}} Laborwerte wurden importiert.',
    processingError: 'Fehler bei der Verarbeitung des Laborberichts.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Laborwerte importieren',
    valueLabel: {
      creatinine: 'Kreatinin',
      totalCholesterol: 'Gesamtcholesterin',
      hdlCholesterol: 'HDL-Cholesterin',
      ldlCholesterol: 'LDL-Cholesterin',
      triglycerides: 'Triglyceride',
      glucose: 'Glukose',
      hba1c: 'HbA1c',
      hemoglobin: 'Hämoglobin',
      leukocytes: 'Leukozyten',
      thrombocytes: 'Thrombozyten',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Harnsäure',
      potassium: 'Kalium',
      sodium: 'Natrium',
      crp: 'CRP',
      systolicBP: 'Systolischer Blutdruck',
      weight: 'Gewicht',
      height: 'Größe',
      age: 'Alter',
    },
  },
  en: {
    title: 'Upload Lab Report',
    selectFile: 'Select File',
    processing: 'Analyzing...',
    valuesFound: '{{count}} values detected',
    importValues: 'Import values ({{count}})',
    noValues: 'No values detected',
    ocrRequired: 'OCR consent required',
    ocrNotAvailable: 'OCR is not available on this device.',
    notSupported: 'Lab report upload is not available on this platform.',
    mobilOnly: 'This feature is only available on iOS and Android.',
    description: 'Upload a lab report (image or PDF). Values will be extracted locally via OCR and can be imported into the calculator.',
    confidence: 'OCR confidence: {{percent}}%',
    noValuesHint: 'Try a sharper image or a different lab report.',
    importHint: '{{count}} values can be imported into the calculator.',
    noImportableHint: 'None of the detected values can be automatically imported into the calculator.',
    noImportableValues: 'No importable values selected.',
    importSuccess: '{{count}} lab values have been imported.',
    processingError: 'Error processing the lab report.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Import lab values',
    valueLabel: {
      creatinine: 'Creatinine',
      totalCholesterol: 'Total Cholesterol',
      hdlCholesterol: 'HDL Cholesterol',
      ldlCholesterol: 'LDL Cholesterol',
      triglycerides: 'Triglycerides',
      glucose: 'Glucose',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobin',
      leukocytes: 'Leukocytes',
      thrombocytes: 'Thrombocytes',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Uric Acid',
      potassium: 'Potassium',
      sodium: 'Sodium',
      crp: 'CRP',
      systolicBP: 'Systolic Blood Pressure',
      weight: 'Weight',
      height: 'Height',
      age: 'Age',
    },
  },
  fr: {
    title: 'Télécharger un rapport de laboratoire',
    selectFile: 'Sélectionner un fichier',
    processing: 'Analyse en cours...',
    valuesFound: '{{count}} valeurs détectées',
    importValues: 'Importer les valeurs ({{count}})',
    noValues: 'Aucune valeur détectée',
    ocrRequired: 'Consentement OCR requis',
    ocrNotAvailable: "L'OCR n'est pas disponible sur cet appareil.",
    notSupported: "Le téléchargement de rapports de laboratoire n'est pas disponible sur cette plateforme.",
    mobilOnly: 'Cette fonctionnalité est uniquement disponible sur iOS et Android.',
    description: "Téléchargez un rapport de laboratoire (image ou PDF). Les valeurs seront extraites localement par OCR et pourront être importées dans le calculateur.",
    confidence: 'Confiance OCR : {{percent}}%',
    noValuesHint: 'Essayez une image plus nette ou un autre rapport.',
    importHint: '{{count}} valeurs peuvent être importées dans le calculateur.',
    noImportableHint: "Aucune des valeurs détectées ne peut être importée automatiquement.",
    noImportableValues: 'Aucune valeur importable sélectionnée.',
    importSuccess: '{{count}} valeurs de laboratoire ont été importées.',
    processingError: 'Erreur lors du traitement du rapport.',
    refRange: 'Réf : {{range}}',
    importFromLab: 'Importer les valeurs de laboratoire',
    valueLabel: {
      creatinine: 'Créatinine',
      totalCholesterol: 'Cholestérol total',
      hdlCholesterol: 'Cholestérol HDL',
      ldlCholesterol: 'Cholestérol LDL',
      triglycerides: 'Triglycérides',
      glucose: 'Glucose',
      hba1c: 'HbA1c',
      hemoglobin: 'Hémoglobine',
      leukocytes: 'Leucocytes',
      thrombocytes: 'Thrombocytes',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Acide urique',
      potassium: 'Potassium',
      sodium: 'Sodium',
      crp: 'CRP',
      systolicBP: 'Pression artérielle systolique',
      weight: 'Poids',
      height: 'Taille',
      age: 'Âge',
    },
  },
  es: {
    title: 'Subir informe de laboratorio',
    selectFile: 'Seleccionar archivo',
    processing: 'Analizando...',
    valuesFound: '{{count}} valores detectados',
    importValues: 'Importar valores ({{count}})',
    noValues: 'No se detectaron valores',
    ocrRequired: 'Se requiere consentimiento OCR',
    ocrNotAvailable: 'OCR no está disponible en este dispositivo.',
    notSupported: 'La carga de informes de laboratorio no está disponible en esta plataforma.',
    mobilOnly: 'Esta función solo está disponible en iOS y Android.',
    description: 'Suba un informe de laboratorio (imagen o PDF). Los valores se extraerán localmente mediante OCR y podrán importarse en la calculadora.',
    confidence: 'Confianza OCR: {{percent}}%',
    noValuesHint: 'Intente con una imagen más nítida u otro informe.',
    importHint: '{{count}} valores pueden importarse en la calculadora.',
    noImportableHint: 'Ninguno de los valores detectados puede importarse automáticamente.',
    noImportableValues: 'No se seleccionaron valores importables.',
    importSuccess: '{{count}} valores de laboratorio han sido importados.',
    processingError: 'Error al procesar el informe de laboratorio.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Importar valores de laboratorio',
    valueLabel: {
      creatinine: 'Creatinina',
      totalCholesterol: 'Colesterol total',
      hdlCholesterol: 'Colesterol HDL',
      ldlCholesterol: 'Colesterol LDL',
      triglycerides: 'Triglicéridos',
      glucose: 'Glucosa',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobina',
      leukocytes: 'Leucocitos',
      thrombocytes: 'Trombocitos',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Ácido úrico',
      potassium: 'Potasio',
      sodium: 'Sodio',
      crp: 'PCR',
      systolicBP: 'Presión arterial sistólica',
      weight: 'Peso',
      height: 'Altura',
      age: 'Edad',
    },
  },
  it: {
    title: 'Carica referto di laboratorio',
    selectFile: 'Seleziona file',
    processing: 'Analisi in corso...',
    valuesFound: '{{count}} valori rilevati',
    importValues: 'Importa valori ({{count}})',
    noValues: 'Nessun valore rilevato',
    ocrRequired: 'Consenso OCR necessario',
    ocrNotAvailable: "L'OCR non è disponibile su questo dispositivo.",
    notSupported: 'Il caricamento dei referti di laboratorio non è disponibile su questa piattaforma.',
    mobilOnly: 'Questa funzione è disponibile solo su iOS e Android.',
    description: 'Carica un referto di laboratorio (immagine o PDF). I valori verranno estratti localmente tramite OCR e potranno essere importati nella calcolatrice.',
    confidence: 'Affidabilità OCR: {{percent}}%',
    noValuesHint: "Prova con un'immagine più nitida o un altro referto.",
    importHint: '{{count}} valori possono essere importati nella calcolatrice.',
    noImportableHint: 'Nessuno dei valori rilevati può essere importato automaticamente.',
    noImportableValues: 'Nessun valore importabile selezionato.',
    importSuccess: '{{count}} valori di laboratorio sono stati importati.',
    processingError: "Errore durante l'elaborazione del referto.",
    refRange: 'Rif: {{range}}',
    importFromLab: 'Importa valori di laboratorio',
    valueLabel: {
      creatinine: 'Creatinina',
      totalCholesterol: 'Colesterolo totale',
      hdlCholesterol: 'Colesterolo HDL',
      ldlCholesterol: 'Colesterolo LDL',
      triglycerides: 'Trigliceridi',
      glucose: 'Glucosio',
      hba1c: 'HbA1c',
      hemoglobin: 'Emoglobina',
      leukocytes: 'Leucociti',
      thrombocytes: 'Trombociti',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Acido urico',
      potassium: 'Potassio',
      sodium: 'Sodio',
      crp: 'PCR',
      systolicBP: 'Pressione arteriosa sistolica',
      weight: 'Peso',
      height: 'Altezza',
      age: 'Età',
    },
  },
  pt: {
    title: 'Carregar relatório laboratorial',
    selectFile: 'Selecionar ficheiro',
    processing: 'A analisar...',
    valuesFound: '{{count}} valores detetados',
    importValues: 'Importar valores ({{count}})',
    noValues: 'Nenhum valor detetado',
    ocrRequired: 'Consentimento OCR necessário',
    ocrNotAvailable: 'OCR não está disponível neste dispositivo.',
    notSupported: 'O carregamento de relatórios laboratoriais não está disponível nesta plataforma.',
    mobilOnly: 'Esta funcionalidade está disponível apenas em iOS e Android.',
    description: 'Carregue um relatório laboratorial (imagem ou PDF). Os valores serão extraídos localmente via OCR e poderão ser importados para a calculadora.',
    confidence: 'Confiança OCR: {{percent}}%',
    noValuesHint: 'Tente uma imagem mais nítida ou outro relatório.',
    importHint: '{{count}} valores podem ser importados para a calculadora.',
    noImportableHint: 'Nenhum dos valores detetados pode ser importado automaticamente.',
    noImportableValues: 'Nenhum valor importável selecionado.',
    importSuccess: '{{count}} valores laboratoriais foram importados.',
    processingError: 'Erro ao processar o relatório laboratorial.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Importar valores laboratoriais',
    valueLabel: {
      creatinine: 'Creatinina',
      totalCholesterol: 'Colesterol total',
      hdlCholesterol: 'Colesterol HDL',
      ldlCholesterol: 'Colesterol LDL',
      triglycerides: 'Triglicéridos',
      glucose: 'Glucose',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobina',
      leukocytes: 'Leucócitos',
      thrombocytes: 'Trombócitos',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Ácido úrico',
      potassium: 'Potássio',
      sodium: 'Sódio',
      crp: 'PCR',
      systolicBP: 'Pressão arterial sistólica',
      weight: 'Peso',
      height: 'Altura',
      age: 'Idade',
    },
  },
  nl: {
    title: 'Laboratoriumrapport uploaden',
    selectFile: 'Bestand selecteren',
    processing: 'Wordt geanalyseerd...',
    valuesFound: '{{count}} waarden gedetecteerd',
    importValues: 'Waarden importeren ({{count}})',
    noValues: 'Geen waarden gedetecteerd',
    ocrRequired: 'OCR-toestemming vereist',
    ocrNotAvailable: 'OCR is niet beschikbaar op dit apparaat.',
    notSupported: 'Het uploaden van laboratoriumrapporten is niet beschikbaar op dit platform.',
    mobilOnly: 'Deze functie is alleen beschikbaar op iOS en Android.',
    description: 'Upload een laboratoriumrapport (afbeelding of PDF). De waarden worden lokaal via OCR geëxtraheerd en kunnen in de calculator worden geïmporteerd.',
    confidence: 'OCR-betrouwbaarheid: {{percent}}%',
    noValuesHint: 'Probeer een scherper beeld of een ander rapport.',
    importHint: '{{count}} waarden kunnen in de calculator worden geïmporteerd.',
    noImportableHint: 'Geen van de gedetecteerde waarden kan automatisch worden geïmporteerd.',
    noImportableValues: 'Geen importeerbare waarden geselecteerd.',
    importSuccess: '{{count}} laboratoriumwaarden zijn geïmporteerd.',
    processingError: 'Fout bij het verwerken van het laboratoriumrapport.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Laboratoriumwaarden importeren',
    valueLabel: {
      creatinine: 'Creatinine',
      totalCholesterol: 'Totaal cholesterol',
      hdlCholesterol: 'HDL-cholesterol',
      ldlCholesterol: 'LDL-cholesterol',
      triglycerides: 'Triglyceriden',
      glucose: 'Glucose',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobine',
      leukocytes: 'Leukocyten',
      thrombocytes: 'Trombocyten',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Urinezuur',
      potassium: 'Kalium',
      sodium: 'Natrium',
      crp: 'CRP',
      systolicBP: 'Systolische bloeddruk',
      weight: 'Gewicht',
      height: 'Lengte',
      age: 'Leeftijd',
    },
  },
  pl: {
    title: 'Prześlij wynik laboratoryjny',
    selectFile: 'Wybierz plik',
    processing: 'Analizowanie...',
    valuesFound: '{{count}} wykrytych wartości',
    importValues: 'Importuj wartości ({{count}})',
    noValues: 'Nie wykryto wartości',
    ocrRequired: 'Wymagana zgoda na OCR',
    ocrNotAvailable: 'OCR nie jest dostępne na tym urządzeniu.',
    notSupported: 'Przesyłanie wyników laboratoryjnych nie jest dostępne na tej platformie.',
    mobilOnly: 'Ta funkcja jest dostępna tylko na iOS i Android.',
    description: 'Prześlij wynik laboratoryjny (obraz lub PDF). Wartości zostaną wyodrębnione lokalnie za pomocą OCR i mogą zostać zaimportowane do kalkulatora.',
    confidence: 'Pewność OCR: {{percent}}%',
    noValuesHint: 'Spróbuj ostrzejszy obraz lub inny wynik.',
    importHint: '{{count}} wartości można zaimportować do kalkulatora.',
    noImportableHint: 'Żadna z wykrytych wartości nie może zostać automatycznie zaimportowana.',
    noImportableValues: 'Nie wybrano wartości do importu.',
    importSuccess: 'Zaimportowano {{count}} wartości laboratoryjnych.',
    processingError: 'Błąd podczas przetwarzania wyniku laboratoryjnego.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Importuj wartości laboratoryjne',
    valueLabel: {
      creatinine: 'Kreatynina',
      totalCholesterol: 'Cholesterol całkowity',
      hdlCholesterol: 'Cholesterol HDL',
      ldlCholesterol: 'Cholesterol LDL',
      triglycerides: 'Trójglicerydy',
      glucose: 'Glukoza',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobina',
      leukocytes: 'Leukocyty',
      thrombocytes: 'Trombocyty',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Kwas moczowy',
      potassium: 'Potas',
      sodium: 'Sód',
      crp: 'CRP',
      systolicBP: 'Ciśnienie skurczowe',
      weight: 'Waga',
      height: 'Wzrost',
      age: 'Wiek',
    },
  },
  tr: {
    title: 'Laboratuvar raporu yükle',
    selectFile: 'Dosya seç',
    processing: 'Analiz ediliyor...',
    valuesFound: '{{count}} değer tespit edildi',
    importValues: 'Değerleri içe aktar ({{count}})',
    noValues: 'Değer tespit edilemedi',
    ocrRequired: 'OCR onayı gerekli',
    ocrNotAvailable: 'Bu cihazda OCR kullanılamıyor.',
    notSupported: 'Laboratuvar raporu yükleme bu platformda kullanılamaz.',
    mobilOnly: 'Bu özellik yalnızca iOS ve Android platformlarında kullanılabilir.',
    description: 'Bir laboratuvar raporu yükleyin (görüntü veya PDF). Değerler yerel olarak OCR ile çıkarılacak ve hesaplayıcıya aktarılabilecektir.',
    confidence: 'OCR güvenilirliği: {{percent}}%',
    noValuesHint: 'Daha net bir görüntü veya farklı bir rapor deneyin.',
    importHint: '{{count}} değer hesaplayıcıya aktarılabilir.',
    noImportableHint: 'Tespit edilen değerlerin hiçbiri otomatik olarak aktarılamaz.',
    noImportableValues: 'Aktarılabilir değer seçilmedi.',
    importSuccess: '{{count}} laboratuvar değeri aktarıldı.',
    processingError: 'Laboratuvar raporu işlenirken hata oluştu.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Laboratuvar değerlerini içe aktar',
    valueLabel: {
      creatinine: 'Kreatinin',
      totalCholesterol: 'Toplam kolesterol',
      hdlCholesterol: 'HDL kolesterol',
      ldlCholesterol: 'LDL kolesterol',
      triglycerides: 'Trigliseritler',
      glucose: 'Glikoz',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobin',
      leukocytes: 'Lökositler',
      thrombocytes: 'Trombositler',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Ürik asit',
      potassium: 'Potasyum',
      sodium: 'Sodyum',
      crp: 'CRP',
      systolicBP: 'Sistolik kan basıncı',
      weight: 'Ağırlık',
      height: 'Boy',
      age: 'Yaş',
    },
  },
  ru: {
    title: 'Загрузить лабораторный отчёт',
    selectFile: 'Выбрать файл',
    processing: 'Анализ...',
    valuesFound: 'Обнаружено {{count}} значений',
    importValues: 'Импортировать значения ({{count}})',
    noValues: 'Значения не обнаружены',
    ocrRequired: 'Требуется согласие на OCR',
    ocrNotAvailable: 'OCR недоступен на этом устройстве.',
    notSupported: 'Загрузка лабораторных отчётов недоступна на этой платформе.',
    mobilOnly: 'Эта функция доступна только на iOS и Android.',
    description: 'Загрузите лабораторный отчёт (изображение или PDF). Значения будут извлечены локально через OCR и могут быть импортированы в калькулятор.',
    confidence: 'OCR-достоверность: {{percent}}%',
    noValuesHint: 'Попробуйте более чёткое изображение или другой отчёт.',
    importHint: '{{count}} значений могут быть импортированы в калькулятор.',
    noImportableHint: 'Ни одно из обнаруженных значений не может быть автоматически импортировано.',
    noImportableValues: 'Не выбраны значения для импорта.',
    importSuccess: 'Импортировано {{count}} лабораторных значений.',
    processingError: 'Ошибка при обработке лабораторного отчёта.',
    refRange: 'Реф: {{range}}',
    importFromLab: 'Импортировать лабораторные значения',
    valueLabel: {
      creatinine: 'Креатинин',
      totalCholesterol: 'Общий холестерин',
      hdlCholesterol: 'Холестерин ЛПВП',
      ldlCholesterol: 'Холестерин ЛПНП',
      triglycerides: 'Триглицериды',
      glucose: 'Глюкоза',
      hba1c: 'HbA1c',
      hemoglobin: 'Гемоглобин',
      leukocytes: 'Лейкоциты',
      thrombocytes: 'Тромбоциты',
      got: 'ГОТ (АСТ)',
      gpt: 'ГПТ (АЛТ)',
      ggt: 'ГГТ',
      tsh: 'ТТГ',
      uricAcid: 'Мочевая кислота',
      potassium: 'Калий',
      sodium: 'Натрий',
      crp: 'СРБ',
      systolicBP: 'Систолическое давление',
      weight: 'Вес',
      height: 'Рост',
      age: 'Возраст',
    },
  },
  ar: {
    title: 'تحميل تقرير مخبري',
    selectFile: 'اختيار ملف',
    processing: 'جارٍ التحليل...',
    valuesFound: 'تم اكتشاف {{count}} قيم',
    importValues: 'استيراد القيم ({{count}})',
    noValues: 'لم يتم اكتشاف أي قيم',
    ocrRequired: 'مطلوب موافقة OCR',
    ocrNotAvailable: 'OCR غير متوفر على هذا الجهاز.',
    notSupported: 'تحميل التقارير المخبرية غير متوفر على هذه المنصة.',
    mobilOnly: 'هذه الميزة متوفرة فقط على iOS و Android.',
    description: 'قم بتحميل تقرير مخبري (صورة أو PDF). سيتم استخراج القيم محلياً عبر OCR ويمكن استيرادها في الآلة الحاسبة.',
    confidence: 'موثوقية OCR: {{percent}}%',
    noValuesHint: 'جرّب صورة أوضح أو تقريراً آخر.',
    importHint: 'يمكن استيراد {{count}} قيم في الآلة الحاسبة.',
    noImportableHint: 'لا يمكن استيراد أي من القيم المكتشفة تلقائياً.',
    noImportableValues: 'لم يتم تحديد قيم قابلة للاستيراد.',
    importSuccess: 'تم استيراد {{count}} قيم مخبرية.',
    processingError: 'خطأ أثناء معالجة التقرير المخبري.',
    refRange: 'المرجع: {{range}}',
    importFromLab: 'استيراد القيم المخبرية',
    valueLabel: {
      creatinine: 'كرياتينين',
      totalCholesterol: 'كولسترول كلي',
      hdlCholesterol: 'كولسترول HDL',
      ldlCholesterol: 'كولسترول LDL',
      triglycerides: 'ثلاثي الغليسريد',
      glucose: 'غلوكوز',
      hba1c: 'HbA1c',
      hemoglobin: 'هيموغلوبين',
      leukocytes: 'كريات بيضاء',
      thrombocytes: 'صفيحات دموية',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'حمض البول',
      potassium: 'بوتاسيوم',
      sodium: 'صوديوم',
      crp: 'CRP',
      systolicBP: 'ضغط الدم الانقباضي',
      weight: 'الوزن',
      height: 'الطول',
      age: 'العمر',
    },
  },
  fa: {
    title: 'بارگذاری گزارش آزمایشگاه',
    selectFile: 'انتخاب فایل',
    processing: 'در حال تحلیل...',
    valuesFound: '{{count}} مقدار شناسایی شد',
    importValues: 'وارد کردن مقادیر ({{count}})',
    noValues: 'هیچ مقداری شناسایی نشد',
    ocrRequired: 'موافقت OCR لازم است',
    ocrNotAvailable: 'OCR در این دستگاه در دسترس نیست.',
    notSupported: 'بارگذاری گزارش آزمایشگاه در این پلتفرم در دسترس نیست.',
    mobilOnly: 'این ویژگی فقط در iOS و Android در دسترس است.',
    description: 'یک گزارش آزمایشگاه بارگذاری کنید (تصویر یا PDF). مقادیر به صورت محلی از طریق OCR استخراج شده و می‌توانند در ماشین‌حساب وارد شوند.',
    confidence: 'اطمینان OCR: {{percent}}%',
    noValuesHint: 'یک تصویر واضح‌تر یا گزارش دیگری را امتحان کنید.',
    importHint: '{{count}} مقدار می‌تواند در ماشین‌حساب وارد شود.',
    noImportableHint: 'هیچ‌یک از مقادیر شناسایی‌شده قابل وارد کردن خودکار نیست.',
    noImportableValues: 'هیچ مقدار قابل واردکردنی انتخاب نشده.',
    importSuccess: '{{count}} مقدار آزمایشگاهی وارد شد.',
    processingError: 'خطا در پردازش گزارش آزمایشگاه.',
    refRange: 'مرجع: {{range}}',
    importFromLab: 'وارد کردن مقادیر آزمایشگاهی',
    valueLabel: {
      creatinine: 'کراتینین',
      totalCholesterol: 'کلسترول کل',
      hdlCholesterol: 'کلسترول HDL',
      ldlCholesterol: 'کلسترول LDL',
      triglycerides: 'تری‌گلیسیرید',
      glucose: 'گلوکز',
      hba1c: 'HbA1c',
      hemoglobin: 'هموگلوبین',
      leukocytes: 'گلبول‌های سفید',
      thrombocytes: 'پلاکت‌ها',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'اسید اوریک',
      potassium: 'پتاسیم',
      sodium: 'سدیم',
      crp: 'CRP',
      systolicBP: 'فشار خون سیستولیک',
      weight: 'وزن',
      height: 'قد',
      age: 'سن',
    },
  },
  zh: {
    title: '上传化验报告',
    selectFile: '选择文件',
    processing: '分析中...',
    valuesFound: '检测到 {{count}} 个值',
    importValues: '导入值 ({{count}})',
    noValues: '未检测到值',
    ocrRequired: '需要OCR同意',
    ocrNotAvailable: '此设备不支持OCR。',
    notSupported: '该平台不支持化验报告上传。',
    mobilOnly: '此功能仅在iOS和Android上可用。',
    description: '上传化验报告（图片或PDF）。数值将通过OCR本地提取，可导入计算器。',
    confidence: 'OCR置信度：{{percent}}%',
    noValuesHint: '请尝试更清晰的图片或其他报告。',
    importHint: '{{count}} 个值可导入计算器。',
    noImportableHint: '检测到的值均无法自动导入。',
    noImportableValues: '未选择可导入的值。',
    importSuccess: '已导入 {{count}} 个化验值。',
    processingError: '处理化验报告时出错。',
    refRange: '参考：{{range}}',
    importFromLab: '导入化验值',
    valueLabel: {
      creatinine: '肌酐',
      totalCholesterol: '总胆固醇',
      hdlCholesterol: 'HDL胆固醇',
      ldlCholesterol: 'LDL胆固醇',
      triglycerides: '甘油三酯',
      glucose: '血糖',
      hba1c: 'HbA1c',
      hemoglobin: '血红蛋白',
      leukocytes: '白细胞',
      thrombocytes: '血小板',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: '尿酸',
      potassium: '钾',
      sodium: '钠',
      crp: 'CRP',
      systolicBP: '收缩压',
      weight: '体重',
      height: '身高',
      age: '年龄',
    },
  },
  ja: {
    title: '検査報告書をアップロード',
    selectFile: 'ファイルを選択',
    processing: '分析中...',
    valuesFound: '{{count}} 件の値を検出',
    importValues: '値をインポート ({{count}})',
    noValues: '値が検出されませんでした',
    ocrRequired: 'OCR同意が必要です',
    ocrNotAvailable: 'このデバイスではOCRを利用できません。',
    notSupported: 'このプラットフォームでは検査報告書のアップロードを利用できません。',
    mobilOnly: 'この機能はiOSとAndroidでのみ利用できます。',
    description: '検査報告書をアップロードしてください（画像またはPDF）。OCRでローカルに値を抽出し、計算機にインポートできます。',
    confidence: 'OCR信頼度：{{percent}}%',
    noValuesHint: 'より鮮明な画像または別の報告書をお試しください。',
    importHint: '{{count}} 件の値を計算機にインポートできます。',
    noImportableHint: '検出された値はいずれも自動インポートできません。',
    noImportableValues: 'インポート可能な値が選択されていません。',
    importSuccess: '{{count}} 件の検査値がインポートされました。',
    processingError: '検査報告書の処理中にエラーが発生しました。',
    refRange: '基準値：{{range}}',
    importFromLab: '検査値をインポート',
    valueLabel: {
      creatinine: 'クレアチニン',
      totalCholesterol: '総コレステロール',
      hdlCholesterol: 'HDLコレステロール',
      ldlCholesterol: 'LDLコレステロール',
      triglycerides: '中性脂肪',
      glucose: '血糖',
      hba1c: 'HbA1c',
      hemoglobin: 'ヘモグロビン',
      leukocytes: '白血球',
      thrombocytes: '血小板',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: '尿酸',
      potassium: 'カリウム',
      sodium: 'ナトリウム',
      crp: 'CRP',
      systolicBP: '収縮期血圧',
      weight: '体重',
      height: '身長',
      age: '年齢',
    },
  },
  ko: {
    title: '검사 보고서 업로드',
    selectFile: '파일 선택',
    processing: '분석 중...',
    valuesFound: '{{count}}개의 값 감지됨',
    importValues: '값 가져오기 ({{count}})',
    noValues: '감지된 값 없음',
    ocrRequired: 'OCR 동의가 필요합니다',
    ocrNotAvailable: '이 기기에서 OCR을 사용할 수 없습니다.',
    notSupported: '이 플랫폼에서 검사 보고서 업로드를 사용할 수 없습니다.',
    mobilOnly: '이 기능은 iOS 및 Android에서만 사용할 수 있습니다.',
    description: '검사 보고서를 업로드하세요 (이미지 또는 PDF). OCR로 로컬에서 값을 추출하여 계산기로 가져올 수 있습니다.',
    confidence: 'OCR 신뢰도: {{percent}}%',
    noValuesHint: '더 선명한 이미지 또는 다른 보고서를 시도해 보세요.',
    importHint: '{{count}}개의 값을 계산기로 가져올 수 있습니다.',
    noImportableHint: '감지된 값 중 자동으로 가져올 수 있는 것이 없습니다.',
    noImportableValues: '가져올 수 있는 값이 선택되지 않았습니다.',
    importSuccess: '{{count}}개의 검사 값을 가져왔습니다.',
    processingError: '검사 보고서 처리 중 오류가 발생했습니다.',
    refRange: '참조: {{range}}',
    importFromLab: '검사 값 가져오기',
    valueLabel: {
      creatinine: '크레아티닌',
      totalCholesterol: '총 콜레스테롤',
      hdlCholesterol: 'HDL 콜레스테롤',
      ldlCholesterol: 'LDL 콜레스테롤',
      triglycerides: '중성지방',
      glucose: '혈당',
      hba1c: 'HbA1c',
      hemoglobin: '헤모글로빈',
      leukocytes: '백혈구',
      thrombocytes: '혈소판',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: '요산',
      potassium: '칼륨',
      sodium: '나트륨',
      crp: 'CRP',
      systolicBP: '수축기 혈압',
      weight: '체중',
      height: '키',
      age: '나이',
    },
  },
  vi: {
    title: 'Tải lên báo cáo xét nghiệm',
    selectFile: 'Chọn tệp',
    processing: 'Đang phân tích...',
    valuesFound: 'Đã phát hiện {{count}} giá trị',
    importValues: 'Nhập giá trị ({{count}})',
    noValues: 'Không phát hiện giá trị nào',
    ocrRequired: 'Cần đồng ý OCR',
    ocrNotAvailable: 'OCR không khả dụng trên thiết bị này.',
    notSupported: 'Tải lên báo cáo xét nghiệm không khả dụng trên nền tảng này.',
    mobilOnly: 'Tính năng này chỉ có trên iOS và Android.',
    description: 'Tải lên báo cáo xét nghiệm (hình ảnh hoặc PDF). Các giá trị sẽ được trích xuất cục bộ qua OCR và có thể được nhập vào máy tính.',
    confidence: 'Độ tin cậy OCR: {{percent}}%',
    noValuesHint: 'Thử hình ảnh rõ hơn hoặc báo cáo khác.',
    importHint: '{{count}} giá trị có thể nhập vào máy tính.',
    noImportableHint: 'Không có giá trị nào phát hiện được có thể nhập tự động.',
    noImportableValues: 'Chưa chọn giá trị nào để nhập.',
    importSuccess: 'Đã nhập {{count}} giá trị xét nghiệm.',
    processingError: 'Lỗi khi xử lý báo cáo xét nghiệm.',
    refRange: 'Tham chiếu: {{range}}',
    importFromLab: 'Nhập giá trị xét nghiệm',
    valueLabel: {
      creatinine: 'Creatinine',
      totalCholesterol: 'Cholesterol toàn phần',
      hdlCholesterol: 'Cholesterol HDL',
      ldlCholesterol: 'Cholesterol LDL',
      triglycerides: 'Triglycerides',
      glucose: 'Glucose',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobin',
      leukocytes: 'Bạch cầu',
      thrombocytes: 'Tiểu cầu',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Acid uric',
      potassium: 'Kali',
      sodium: 'Natri',
      crp: 'CRP',
      systolicBP: 'Huyết áp tâm thu',
      weight: 'Cân nặng',
      height: 'Chiều cao',
      age: 'Tuổi',
    },
  },
  uk: {
    title: 'Завантажити лабораторний звіт',
    selectFile: 'Вибрати файл',
    processing: 'Аналіз...',
    valuesFound: 'Виявлено {{count}} значень',
    importValues: 'Імпортувати значення ({{count}})',
    noValues: 'Значення не виявлено',
    ocrRequired: 'Потрібна згода на OCR',
    ocrNotAvailable: 'OCR недоступний на цьому пристрої.',
    notSupported: 'Завантаження лабораторних звітів недоступне на цій платформі.',
    mobilOnly: 'Ця функція доступна лише на iOS та Android.',
    description: 'Завантажте лабораторний звіт (зображення або PDF). Значення будуть витягнуті локально через OCR і можуть бути імпортовані в калькулятор.',
    confidence: 'Достовірність OCR: {{percent}}%',
    noValuesHint: 'Спробуйте чіткіше зображення або інший звіт.',
    importHint: '{{count}} значень можна імпортувати в калькулятор.',
    noImportableHint: 'Жодне з виявлених значень не може бути автоматично імпортоване.',
    noImportableValues: 'Не вибрано значень для імпорту.',
    importSuccess: 'Імпортовано {{count}} лабораторних значень.',
    processingError: 'Помилка при обробці лабораторного звіту.',
    refRange: 'Реф: {{range}}',
    importFromLab: 'Імпортувати лабораторні значення',
    valueLabel: {
      creatinine: 'Креатинін',
      totalCholesterol: 'Загальний холестерин',
      hdlCholesterol: 'Холестерин ЛПВЩ',
      ldlCholesterol: 'Холестерин ЛПНЩ',
      triglycerides: 'Тригліцериди',
      glucose: 'Глюкоза',
      hba1c: 'HbA1c',
      hemoglobin: 'Гемоглобін',
      leukocytes: 'Лейкоцити',
      thrombocytes: 'Тромбоцити',
      got: 'ГОТ (АСТ)',
      gpt: 'ГПТ (АЛТ)',
      ggt: 'ГГТ',
      tsh: 'ТТГ',
      uricAcid: 'Сечова кислота',
      potassium: 'Калій',
      sodium: 'Натрій',
      crp: 'СРБ',
      systolicBP: 'Систолічний тиск',
      weight: 'Вага',
      height: 'Зріст',
      age: 'Вік',
    },
  },
  ro: {
    title: 'Încărcați raport de laborator',
    selectFile: 'Selectați fișier',
    processing: 'Se analizează...',
    valuesFound: '{{count}} valori detectate',
    importValues: 'Importă valori ({{count}})',
    noValues: 'Nicio valoare detectată',
    ocrRequired: 'Consimțământ OCR necesar',
    ocrNotAvailable: 'OCR nu este disponibil pe acest dispozitiv.',
    notSupported: 'Încărcarea rapoartelor de laborator nu este disponibilă pe această platformă.',
    mobilOnly: 'Această funcție este disponibilă doar pe iOS și Android.',
    description: 'Încărcați un raport de laborator (imagine sau PDF). Valorile vor fi extrase local prin OCR și pot fi importate în calculator.',
    confidence: 'Încredere OCR: {{percent}}%',
    noValuesHint: 'Încercați o imagine mai clară sau un alt raport.',
    importHint: '{{count}} valori pot fi importate în calculator.',
    noImportableHint: 'Niciuna dintre valorile detectate nu poate fi importată automat.',
    noImportableValues: 'Nicio valoare importabilă selectată.',
    importSuccess: '{{count}} valori de laborator au fost importate.',
    processingError: 'Eroare la procesarea raportului de laborator.',
    refRange: 'Ref: {{range}}',
    importFromLab: 'Importă valori de laborator',
    valueLabel: {
      creatinine: 'Creatinină',
      totalCholesterol: 'Colesterol total',
      hdlCholesterol: 'Colesterol HDL',
      ldlCholesterol: 'Colesterol LDL',
      triglycerides: 'Trigliceride',
      glucose: 'Glucoză',
      hba1c: 'HbA1c',
      hemoglobin: 'Hemoglobină',
      leukocytes: 'Leucocite',
      thrombocytes: 'Trombocite',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Acid uric',
      potassium: 'Potasiu',
      sodium: 'Sodiu',
      crp: 'PCR',
      systolicBP: 'Tensiune arterială sistolică',
      weight: 'Greutate',
      height: 'Înălțime',
      age: 'Vârstă',
    },
  },
  el: {
    title: 'Ανεβάστε εργαστηριακή αναφορά',
    selectFile: 'Επιλέξτε αρχείο',
    processing: 'Ανάλυση...',
    valuesFound: 'Ανιχνεύθηκαν {{count}} τιμές',
    importValues: 'Εισαγωγή τιμών ({{count}})',
    noValues: 'Δεν ανιχνεύθηκαν τιμές',
    ocrRequired: 'Απαιτείται συναίνεση OCR',
    ocrNotAvailable: 'Το OCR δεν είναι διαθέσιμο σε αυτή τη συσκευή.',
    notSupported: 'Η μεταφόρτωση εργαστηριακών αναφορών δεν είναι διαθέσιμη σε αυτή την πλατφόρμα.',
    mobilOnly: 'Αυτή η λειτουργία είναι διαθέσιμη μόνο σε iOS και Android.',
    description: 'Ανεβάστε μια εργαστηριακή αναφορά (εικόνα ή PDF). Οι τιμές θα εξαχθούν τοπικά μέσω OCR και μπορούν να εισαχθούν στον υπολογιστή.',
    confidence: 'Αξιοπιστία OCR: {{percent}}%',
    noValuesHint: 'Δοκιμάστε μια πιο ευκρινή εικόνα ή μια διαφορετική αναφορά.',
    importHint: '{{count}} τιμές μπορούν να εισαχθούν στον υπολογιστή.',
    noImportableHint: 'Καμία από τις ανιχνευμένες τιμές δεν μπορεί να εισαχθεί αυτόματα.',
    noImportableValues: 'Δεν επιλέχθηκαν εισαγώγιμες τιμές.',
    importSuccess: 'Εισήχθησαν {{count}} εργαστηριακές τιμές.',
    processingError: 'Σφάλμα κατά την επεξεργασία της εργαστηριακής αναφοράς.',
    refRange: 'Αναφ: {{range}}',
    importFromLab: 'Εισαγωγή εργαστηριακών τιμών',
    valueLabel: {
      creatinine: 'Κρεατινίνη',
      totalCholesterol: 'Ολική χοληστερόλη',
      hdlCholesterol: 'Χοληστερόλη HDL',
      ldlCholesterol: 'Χοληστερόλη LDL',
      triglycerides: 'Τριγλυκερίδια',
      glucose: 'Γλυκόζη',
      hba1c: 'HbA1c',
      hemoglobin: 'Αιμοσφαιρίνη',
      leukocytes: 'Λευκοκύτταρα',
      thrombocytes: 'Θρομβοκύτταρα',
      got: 'GOT (AST)',
      gpt: 'GPT (ALT)',
      ggt: 'GGT',
      tsh: 'TSH',
      uricAcid: 'Ουρικό οξύ',
      potassium: 'Κάλιο',
      sodium: 'Νάτριο',
      crp: 'CRP',
      systolicBP: 'Συστολική αρτηριακή πίεση',
      weight: 'Βάρος',
      height: 'Ύψος',
      age: 'Ηλικία',
    },
  },
};

// Flatten helper for comparison
function flattenKeys(obj, prefix = '') {
  if (!obj || typeof obj !== 'object') return [];
  const keys = [];
  for (const key of Object.keys(obj)) {
    const fullKey = prefix ? `${prefix}.${key}` : key;
    if (obj[key] && typeof obj[key] === 'object' && !Array.isArray(obj[key])) {
      keys.push(...flattenKeys(obj[key], fullKey));
    } else {
      keys.push(fullKey);
    }
  }
  return keys;
}

// Deep set a value in an object at a dot-separated path
function deepSet(obj, path, value) {
  const parts = path.split('.');
  let current = obj;
  for (let i = 0; i < parts.length - 1; i++) {
    if (!current[parts[i]] || typeof current[parts[i]] !== 'object') {
      current[parts[i]] = {};
    }
    current = current[parts[i]];
  }
  current[parts[parts.length - 1]] = value;
}

// Deep get
function deepGet(obj, path) {
  const parts = path.split('.');
  let current = obj;
  for (const p of parts) {
    if (!current || typeof current !== 'object') return undefined;
    current = current[p];
  }
  return current;
}

let totalFixed = 0;

const localeFiles = fs.readdirSync(LOCALES_DIR).filter(f => f.endsWith('.json'));
const enPath = path.join(LOCALES_DIR, 'en.json');
const enData = JSON.parse(fs.readFileSync(enPath, 'utf-8'));
const canonicalKeys = flattenKeys(enData.labUpload, 'labUpload');

for (const file of localeFiles) {
  const code = file.replace('.json', '');
  const filePath = path.join(LOCALES_DIR, file);
  const data = JSON.parse(fs.readFileSync(filePath, 'utf-8'));

  // Get current labUpload keys
  const currentKeys = new Set(flattenKeys(data.labUpload || {}, 'labUpload'));
  const missingKeys = canonicalKeys.filter(k => !currentKeys.has(k));

  if (missingKeys.length === 0) {
    console.log(`  ${code}: OK (all labUpload keys present)`);
    continue;
  }

  // Use locale-specific translations if available, fallback to English
  const translations = TRANSLATIONS[code] || TRANSLATIONS.en;

  for (const key of missingKeys) {
    // key is like "labUpload.valueLabel.age"
    const subKey = key.replace('labUpload.', '');
    const value = deepGet(translations, subKey) || deepGet(TRANSLATIONS.en, subKey);
    if (value !== undefined) {
      deepSet(data, key, value);
    }
  }

  // Overwrite the labUpload section entirely with full translations to ensure completeness
  if (TRANSLATIONS[code]) {
    data.labUpload = TRANSLATIONS[code];
  }

  fs.writeFileSync(filePath, JSON.stringify(data, null, 2) + '\n', 'utf-8');
  console.log(`  ${code}: FIXED (${missingKeys.length} keys added)`);
  totalFixed += missingKeys.length;
}

console.log(`\nDone. Fixed ${totalFixed} missing keys across all locales.`);
